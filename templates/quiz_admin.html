{% extends "base.html" %}
{% set active_page = "profile" %}

{% block content %}

    <div class="container">

        {% for quiz in quizzes %}
            {% if quiz._id|string == url_quiz_id|string %}
                <h1 class="center-align">{{ quiz.quiz_name }}</h1>

                <p>Being Quiz Master is so simple. Click the “Publish” button to launch the quiz. 
                When everyone is ready, launch the first question. When all teams have answered 
                it, launch the next question and so on until each question in each category have 
                been asked.</p>
                <p> Keep an eye on how each team is doing in the “Scores” tab. At the end of each 
                round update the scores so that everyone can see them. Create a bit of excitement 
                by calling out the top three in advance!</p>
                <br>

                <!-- Publish Button -->
                <div class="button-div">
                    <a href="{{ url_for('play', quiz_id=quiz._id) }}"
                        class="btn-large waves-effect waves-light bg-color-green text-shadow">
                        Publish 
                        <i class="fas fa fa-upload"></i>
                    </a>
                </div>
                <br>

                <!-- Collapsibles Section -->
                <ul class="collapsible popout">

                    <!-- Rounds Questions Section -->
                    <li>
                        <div class="collapsible-header">
                            ROUNDS
                        </div>
                        <div class="row collapsible-body">
                            <ul class="collapsible">

                                <!-- Extract the individual categories -->
                                {% for n in quiz.categories %}
                                    <li>
                                        <!-- Individual Rounds Header Section -->
                                        <div class="collapsible-header">
                                            <h6 class="inline-block"><strong>Round {{ loop.index }} - </strong>{{ n.name }}</h6>
                                        </div>
                                        <!-- Individual Rounds Body Section for Answers -->
                                        <div class="collapsible-body">
                                            {% for question in quiz_questions %}
                                                <div class="questions-row-div row">
                                                    <i class="questions-row-icon inline-block fas fa-times col s2 m1"></i>
                                                    <!-- Safe filter escapes unicode charactyers as delivered by the API call-->
                                                    <p class="questions-row inline-block col s10 m9">{{ question.question|safe }}</p>
                                                    <p class="questions-row difficulty inline-block col s12 m2"><strong>Difficulty: </strong>TBC</p>
                                                </div>
                                                <div class="answer_button_row row">
                                                    <button type="submit" class="answer_button btn-small submit waves-effect waves-light bg-color-green text-shadow col s12 m6">
                                                        {{ question.correct_answer|safe }}
                                                    </button>
                                                    <button type="submit" class="answer_button btn-small submit waves-effect waves-light bg-color-green text-shadow col s12 m6">
                                                        Answer 2
                                                    </button>
                                                    <button type="submit" class="answer_button btn-small submit waves-effect waves-light bg-color-green text-shadow col s12 m6">
                                                        Answer 3
                                                    </button>
                                                    <button type="submit" class="answer_button btn-small submit waves-effect waves-light bg-color-green text-shadow col s12 m6">
                                                        Answer 4
                                                    </button>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </li>

                    <!-- Rounds Scores Section -->
                    <li>
                        <div class="collapsible-header">
                            SCORES
                        </div>
                        <div class="collapsible-body">
                            <div class="row">
                                <div class="col s12">
                                    <ul class="tabs">
                                        <li class="tab col s3"><a href="#overall">Overall</a></li>
                                        {% for n in range(1, quiz.rounds|int +1) %}
                                            <li class="tab col s3"><a href="#round1">Round {{ n }}</a></li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                <div id="overall" class="col s12">Overall Scores</div>
                                <div id="round1" class="col s12">Round 1 Scores</div>

                            </div>
                        </div>
                    </li>

                    <!-- Quiz Details Section -->
                    <li>
                        <div class="collapsible-header">
                            DETAILS
                        </div>
                        <div class="collapsible-body"><span>
                            <div id="details-form-row" class="row">
                                <form  id="details-form" class="col s12 m8 offset-m2" method="POST" action="{{ url_for('create') }}">
                                    <div id="details-card-panel" class="card-panel">

                                        <!-- 1. Quiz Name-->
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <i class="fas fa-user-plus prefix color-green tooltipped" data-position="bottom" 
                                                    data-tooltip="Add a name for your quiz. Max 20 Characters."></i>
                                                <input id="quiz_name" name="quiz_name" type="text" minlength="5" 
                                                    maxlength="20" class="validate" value="{{ quiz.quiz_name }}" required>
                                                <label for="quiz_name">Quiz Name*</label>
                                            </div>
                                        </div>

                                        <!-- 2. Rounds -->
                                        <div id="rounds-row" class="row">
                                            <div class="input-field col s12">
                                                <i class="fas fa-arrows-alt prefix color-green tooltipped" data-position="bottom" 
                                                    data-tooltip="Select the number of rounds in your quiz"></i>
                                                <input id="rounds" name="rounds" type="number" min="1" max="10"
                                                    class="validate" value="{{ quiz.rounds }}" required>
                                                <label for="rounds">Rounds*</label>
                                            </div>
                                        </div>

                                        <!-- 3 Categories -->
                                        <div id="categories_row" class="row categories_row">
                                                <div class="input-field col xs12 s6 l4">
                                                    <div class="select-wrapper">
                                                        <select id="round" name="round" style="display:block;" required>
                                                            <option class="cats_first" value="" disabled selected>Round{{ quiz.categories }}</option>
                                                            <option value="">xyz</option>
                                                        </select>
                                                    </div>
                                                </div>
                                        </div>

                                        <!-- 4. Questions per Round-->
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <i class="fas fa-question-circle prefix color-green tooltipped" data-position="bottom" 
                                                    data-tooltip="Select the number of questions in each round"></i>
                                                <input id="questions" name="questions" type="number" min="1" max="10"
                                                    class="validate" value="{{ quiz.questions }}" required>
                                                <label for="questions">Questions*</label>
                                            </div>
                                        </div>

                                        <!-- 5. Questions Difficulty -->
                                        <div class="row">
                                            <div class="input-field col s4">
                                                <i class="fas fa-dumbbell prefix color-green tooltipped" data-position="bottom" 
                                                    data-tooltip="Choose the difficulty of individual questions. The total for
                                                        all three options should match the number of questions per round"></i>
                                                <input id="easy" name="easy" type="number" min="0"
                                                    class="validate" value="{{ quiz.easy }}" required>
                                                <label id="label_easy" for="easy">Easy*</label>
                                            </div>
                                            <div class="input-field col s4">
                                                <input id="medium" name="medium" type="number" min="0"
                                                    class="validate" value="{{ quiz.medium }}" required>
                                                <label id="label_medium" for="medium">Med*</label>
                                            </div>
                                            <div class="input-field col s4">
                                                <input id="hard" name="hard" type="number" min="0" 
                                                    class="validate" value="{{ quiz.hard }}" required>
                                                <label id="label_hard" for="hard">Hard*</label>
                                            </div>
                                        </div>

                                        <!-- 6. Invitees -->
                                        <div class="row">
                                            <div class="input-field col s12">
                                                <i class="fas fa-door-open prefix color-green tooltipped" data-position="bottom" 
                                                    data-tooltip="Add individual email addresses for those you want to take part.
                                                        Separate individual addresses with a comma and a space. E.G. - name1@quiz.com, name2@quiz.com"></i>
                                                <textarea id="invitees" name="invitees" text="text" class="materialize-textarea"></textarea>
                                                <label for="invitees">Invitees (comma separate emails)</label>
                                            </div>
                                        </div>

                                        <!-- Create & Cancel Buttons-->
                                        <div class="row">
                                            <div id="create-button-div" class="button-div col s12 m6">
                                                <button id="create-button" type="submit" class="btn-large submit waves-effect waves-light bg-color-green text-shadow">
                                                    Update <i class="fas fa-plus-circle"></i>
                                                </button>
                                            </div>
                                            <div class="button-div col s12 m6">
                                                <a href="{{ url_for('profile', username=session['user']) }}" class="btn-large waves-effect waves-light red text-shadow">
                                                    Cancel
                                                    <i class="fas fa-times-circle"></i>
                                                </a>
                                            </div>
                                        </div>

                                    </div>
                                </form>
                            </div>
                        </span></div>
                    </li>
                </ul>
                <br>
            
                <!-- Publish & Delete Buttons-->
                <div class="flex">
                    <div class="button-div">
                        <a href="{{ url_for('profile', username=session['user']) }}" class="btn-large waves-effect waves-light bg-color-green text-shadow">
                            All Quizzes 
                            <i class="fas fa-object-group"></i>
                        </a>
                    </div>
                
                    <div class="button-div">
                        <a href="{{ url_for('delete_quiz', quiz_id=quiz._id) }}"
                            class="btn-large waves-effect waves-light red text-shadow">
                            Delete <i class="fas fa-times-circle"></i>
                        </a>
                    </div>
                </div>
                <br>
                <div class="row alignC">
                    <h5>Player link to access the quiz</h5>
                    <p>https://8080-ba9fe4fb-5fe7-4a7b-8e55-99e82b8a73e7.ws-eu01.gitpod.io/play/{{ quiz._id }}</p>
                </div>
            {% endif %}
        {% endfor %} 

    </div>

{% endblock %}

{% block parallax2 %}

    <div class="parallax-container">
        <div class="parallax">
            <img src="{{ url_for('static', filename='images/three_lightbulbs.png') }}" alt="Quiz Light Bulbs" class="responsive-img">
        </div>
    </div>

{% endblock %}